# Backend notes


## Local development
1. In the root of project create .env.development from .env.example

2. Build Dockerfile.dev-db image (fill the build args with .env.local variables):
```
docker build -t yum-lab-db -f Dockerfile.dev-db . --build-arg DB_USER=db-user --build-arg DB_PASSWORD=root --build-arg DB_NAME=yum-lab-db --build-arg DB_PORT=5432
```

3. Run the database container and delete container if it already exists:
```
docker rm -f yum-lab-db; docker run -d -p 5432:5432 --name yum-lab-db yum-lab-db
```

5. Navigate to /backend directory

6. Install dependencies:
```
npm install
```

8. Generate prisma client
```
npm run prisma:client
```

7. Run database migrations and every time when you make changes in /backend/src/db/schema.prisma file too
```
npm run dev:migrate
```

8. Start development server:
```
npm run dev
```


## ðŸ“‚ Backend structure
```python
backend/
  â”œâ”€â”€ src/                  # Application source code
  â”‚   â”œâ”€â”€ controllers/      # Controllers for endpoints
  â”‚   â”œâ”€â”€ db/               # Database source code
  â”‚   |   â”œâ”€â”€ client/       # Database client generated by Prisma
  â”‚   â”‚   â”œâ”€â”€ migrations/   # Migrations source code generated by Prisma
  â”‚   |   â”œâ”€â”€ connection.ts # Database connection
  â”‚   â”‚   â”œâ”€â”€ schema.prisma # Prisma models 
  â”‚   â”‚   â””â”€â”€ seed.ts       # Database seeding
  â”‚   â”œâ”€â”€ routes/           # Routes source code (one file for one controller)
  â”‚   â”‚   â””â”€â”€ index.ts      # Main routing file (importing all routes files)
  â”‚   â”œâ”€â”€ services/         # Services for endpoints (one service file for one controller)
  â”‚   â””â”€â”€ server.ts         # Server entry point
  â”œâ”€â”€ nodemon.json          # Nodemon configuration
  â””â”€â”€ tsconfig.json         # TypeScript configuration
```


## Technologies and libraries
- **Node.js** - JavaScript runtime environment. [docs](https://nodejs.org/docs/latest-v16.x/api/).
- **TypeScript** - A typed superset of JavaScript that compiles to plain JavaScript [docs](https://www.typescriptlang.org/docs/).
- **Expres.js** - Web framework for Node.js [docs](https://expressjs.com/).
- **Prisma** - ORM for TypeScript [docs](https://www.prisma.io/docs/concepts).
- **Zod** - Schema validator [docs](https://zod.dev).
- **Axios** - HTTP Client for node.js and browser [docs](https://axios-http.com/docs/intro).
